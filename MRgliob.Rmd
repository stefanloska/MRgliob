---
title: "Mouse and Rat glioblastoma models"
author: "Stefan Loska"
date: "March 14, 2017"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, libraries}
library(oligo)
library(Biobase)
library(AnnotationDbi)
```

# Get expression

## Reading data

Read data from cel files and probe annotation file.

```{r }
read_cell <- function(dir, pData){
  # get sample meta data
  tab <- read.delim(paste(dir, pData, sep = "/"), stringsAsFactors = F)
  rownames(tab) <- tab$filename

  # get microarray signal
  ab <- read.celfiles(filenames = list.celfiles(dir, full.names = T), phenoData = AnnotatedDataFrame(tab))
  ab
}
```


## Preprocessing

RMA

```{r }
rma_core <- function(ab){
  R <- oligo::rma(ab, target = "core")
  R
}
```







